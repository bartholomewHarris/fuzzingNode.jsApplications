<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
<style>
body{
	font-family:Helvetica;
	margin:0;
	padding:0;
	overflow:auto;
}
html{
	height:100%;
}
a{
	text-decoration:none;
	outline: 0;
	color:#000;
}
a:active{
	color:#000;
}
hr{
    border: 0;
    height: 1px;
    background-image: linear-gradient(to right, #000000 1%,#ffffff 100%);
}
label{
	cursor:pointer;
}
/*.row{


}*/


.accordion{

}

.accordion-closed{
	height:0px;
	overflow:hidden;
}


/*.accordion-open{
	overflow:visible;
}*/



.parent-url{
	margin:0;
	color:gray;
	font-size:11px;
}

.url-post-data, .result-post-data{
	margin:0;
	color:#5A5A60;
	font-size:12px;
}

.mainAccordion{
	margin:0px 0px 0px 20px;
	border-left:1px dotted #047288;
	padding-left:6px;
}

.result-accordion-hdr{
	margin:3px 3px 3px -3px;
	font-weight:bold;
	cursor:pointer;
}


.result-accordion-hdr.hdr-accordion-open:before{
	line-height:24px;
	color:gray;
	font-size:10px;
	content: "▼ ";
}

.result-accordion-hdr.hdr-accordion-closed:before{
	line-height:24px;
	color:gray;
	font-size:10px;
	content: "► ";
}

/* must have margin and padding = 0 to be collapsed on scroll */
#collapse_top{
	position:relative;
	overflow: hidden;
	padding:0px;
	margin:0px;
}

#top_header{
	margin:10px 0 0 10px;
}

#title{
	margin:0 0 10px 0;
	padding:0;
	font-weight:bold;
}

#top{
	position:fixed;
	background-color:#fff;
	z-index:777;
	top:0;
	left:0;
	margin:0;
	min-width:900px;
	width:100%;
}
#top hr{
	max-width:1200px;
	margin:0;
}

#filtersbox{
	margin:10px 0 0 10px;
}

.hidden{ display: none !important}

.icon {
	display: inline-block;

	background-color:#047288;
	padding:4px;
	padding-top:2px;
	padding-bottom:2px;
	border-radius:2px;
	color:#fff;
	margin-right:2px;
	margin-left:1px;
	cursor:default;
	font-size:10px;
}

section{
	margin:0px 0px 10px 10px;
	padding:0;
	white-space: nowrap;
}

section.marked{
	border-left:4px solid #00F500;
	margin-left:6px;
}

section.marked .mark-button:before{
	content:"un";
}

.icon.icon-filtered{
	opacity:0.5;
}
.open-new-win{
	display:inline-block;
	background-image: url(data:image/png;base64,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);
	width:12px;
	height:12px;
	margin-left:6px;
	margin-right:2px;
	background-size: 100% auto;
}

#urlhider, #reshider{
	width:300px;
	height:40px;
}


.modal-bar{
	background-color:#E1EBF7;
	padding:3px;
	margin:0 0 6px 0;
	border:1px solid #fff;
	border-bottom:1px solid #C6DCF5;
}

.modal-content{
	position:relative;
	margin:0;
	padding:0;
	height:calc(100% - 40px);
	width:100%;
	overflow:auto;
}


/*#trash section, #marked section{
	display:block !important;
}
*/

.modal{
	position:fixed;
	top:10px;
	left:10px;
	border:1px solid #047288;
	background-color:#fff;
	width:calc(100% - 20px);
	height:calc(100% - 20px);
	overflow:auto;
	z-index:888;
	box-shadow: 5px 5px 2px #ddd;
}

#buttons{
	position:relative;
	margin:10px 0 5px 10;
	padding:0;
}

.button,.button-spacer{
	display:inline-block;
	height:16px;
	padding:0 4px 1px 4px;
	font-size:13px;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none; 
}


.button-spacer{
	border-left:1px dotted gray;
	width:1px;
}

.button{
	border:1px solid gray;
	min-width:60px;
	cursor:pointer;
	text-align:center;
	margin-right:10px;
}

.button:active{
	opacity:0.6;
}

/*#save_status{
	display:inline-block;
	padding:0;
	margin:0;
}
#save_status input{
	display:inline-block;
	height:16px;
	padding:0 4px 1px 4px;
	border: 1px dashed gray;
}
*/
.result-button{
	margin-top:10px;
}

/*@keyframes button-fadein {
	from {opacity:0.5;}
	to {opacity:1;}
}*/

.button-delayed{

   -webkit-transition: opacity 0.6s ease-in;
       -moz-transition: opacity 0.6s ease-in;
        -ms-transition: opacity 0.6s ease-in;
         -o-transition: opacity 0.6s ease-in;
            transition: opacity 0.6s ease-in;
    opacity:0.5;
}
.button-delayed:hover{
	opacity:1;

}
/*#trash .trash-button{
	opacity:1;
}
*/
#trash .trash-button:before{
	content:"un";
}


#trash-close, #marked-close, #outofscope-close, #vulnerability-close, #request-close, #nonhtml-close, #notes-close{
	position:absolute;
	right:10px;
	top:0px;
	font-size:22px;
	cursor:pointer;
}
#trash-close:hover, #marked-close:hover, #outofscope-close:hover, #nonhtml-close:hover, #notes-close:hover, #vulnerability-close:hover, #request-close:hover{
	color:#F04158;
}


.resbuttons{
	margin-top:10px;
}

#infos{

}
.addregexp{
	margin:2px 0 0 0;
	font-size:12px;
	cursor:pointer;
	text-decoration:underline;
}

.url{
	cursor:pointer;
	display:inline-block;
	vertical-align: bottom;


	white-space:nowrap;

	padding:0;
	margin:0;

	/*border-right-width: 13px;
	border-right-style: solid;
	border-image-slice: 1;
	border-image:linear-gradient(to right, rgba(255,255,255,0) 0%,rgba(0,0,0,1) 100%);;*/
}

#error_container{
	font-size:12px;
	color:red;
}

.url-error{
	color:red;
}

.url-outofscope{
	color:gray;
}


.icon-hidden{
	opacity:0.05 !important;
}

.result{
	font-size:14px;
}


#outofscope p{
	margin: 2px 0 6px 4px;
}
#outofscope p .parent-url{
	padding-left:6px;
}

#nonhtml p{
	margin: 2px 0 6px 4px;
}
#nonhtml p .parent-url{
	padding-left:6px;
}

.result-counter{
	display: inline-block;
	font-weight:normal;
	background-color:#fff;
	margin:0;
	font-size:9px;
	margin:0px 0 -2px -1px;
	border:1px solid #047288;
	border-radius:6px;
	padding:0px 2px 0px 2px;
	vertical-align: bottom;
}

.results{
	margin-bottom:8px;
}

!.accordion-open + p{
	color:red;
}

#vulnerability pre{
	padding:5px;
}

.vuln-name{
	cursor:pointer;
}


.trigger, .opener{
	display: inline-block;
	margin:0 4px 0 0;
	padding: 1;

	min-width:12px;
	height:12px;
	cursor:pointer;
	text-align:center;
	font-size:13px;
	line-height:14px;
	color:#02582F;
}

span.opener{

}

span.trigger.empty{
	opacity:.1;
	cursor:default;
}



#notes textarea{
	display:block;
	margin:0 auto;
	width:95%;
	height:100%;
	font-size:14px;
	padding:10px;
}


.requestdetail-table tr{
	margin:2px;
}

.requestdetail-table td{
	vertical-align: top;
	padding:5px;
	margin:0;
}

.requestdetail-table td:first-child{
	width:25%;
	text-align:right;
	padding-right:15px;
}

.requestdetail-table textarea{
	height:150px;
	width:600px;
}

.json-print{
	display:block;
	overflow:auto;
	padding:6px;
	border:1px solid #000;
}
.json-print p{
	margin:3px;
}
.jsn-prop{
	color:#aa1111;
}
.jsn-number{
	color:#116644;
	font-weight: bold;
}
.jsn-string{
	color:#0B41F9;
}
.jsn-boolean{
	color:#A08301;
}
.jsn-null{
	color: #E12711;
}
</style>
<script>
var report = {"infos": {"htcap_version": "1.1", "target": "http://localhost:8081/", "start_date": 1619770563, "end_date": 1619770566, "commandline": "-A badmin:bpass -w -t 10800 localhost:8081 htcap_mongoexpress_report.db", "user_agent": "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3582.0 Safari/537.36", "cookies": "[]", "proxy": "null", "extra_headers": "false", "pages_crawled": 1}, "results": [{"id": 1, "url": "http://badmin:bpass@localhost:8081/", "type": "link", "method": "GET", "data": "", "referer": null, "cookies": "[]", "extra_headers": "{}", "xhr": [], "fetch": [], "jsonp": [], "websocket": [], "form": [], "errors": ["response", "response"], "vulnerabilities": []}]};



var types = ['xhr', 'fetch', 'jsonp','websocket', 'form', 'vulnerabilities','errors'];

function getIcon(type, founds){
	var icons = {
		form:"F",
		xhr: "X",
		fetch: "E",
		jsonp: "J",
		errors: null, 
		websocket: "W",
		vulnerabilities:"V"
	};

	if(icons[type] != null){
		var iconclass = founds.indexOf(type) > -1 ? ".icon" : ".icon.icon-hidden";
		return newElement("span" + iconclass,[ 'data-for', type,'title',getLabel(type) ], icons[type]);
	}
	return null;
}


function getLabel(type){
	var labels = {
		form:"Forms",
		xhr: "XHR",
		fetch: "Fetch",
		jsonp: "JSONP", 
		errors: "Errors", 
		websocket: "Web Sockets",
		vulnerabilities: "Vulnerabilities"
	};

	if(type in labels)
		return labels[type];

	return null;
}

// code_injection*,file_inclusion*,path_traversal*,rfi*,xss*,xxe*

function getVulnName(type){
	var labels = {
		xss:"Cross Site Scripting (XSS)",
		sqli: "Sql Injection", 
		lfi: "Local File Inclusion", 

	};
	type = type.toLowerCase();
	if(type in labels)
		return labels[type];

	return type;
}


function newElement(name, attributes, content, appendTo){
	var a;
	name = name.split(".");

	var el = document.createElement(name.splice(0,1));
	if(attributes && attributes.length > 0){
		if(attributes.length % 2 != 0) console.error("newEvent: attributes.length must be even");
		for(a = 0; a < attributes.length - 1; a += 2){
			el.setAttribute(attributes[a], attributes[a+1]);
		}
	}

	for(a = 0; a < name.length; a++)
		el.classList.add(name[a]);

	if(content){
		if(content.constructor != Array)
			content = [content];
		for(var cont of content){
			el.appendChild((typeof cont == 'object' && 'tagName' in cont) ? cont : document.createTextNode(cont));
		}
	}

	if(appendTo){
		appendTo.appendChild(el);
	}

	return el;
}

function query(selector, element){
	selector = selector.trim();
	if(selector.match(/^#\S+$/gi) != null){
		// a LOT faster than querySelectorAll
		return document.getElementById(selector.substring(1));
	}
	element = element || document;

	var ret = element.querySelectorAll(selector);


	return ret;

}


function elementHeight(element){
	var style = getComputedStyle(element);
	var margins = parseInt(style.getPropertyValue("margin-top")) + parseInt(style.getPropertyValue("margin-bottom"));
	return element.offsetHeight + margins;
}


function toggleTrashSection(target){
	if(target.parentNode.parentNode.id == "trash"){
		insertSection(target);
	} else{
		query('#trash .modal-content')[0].appendChild(target);
	}
}

function prettyprintRequestData(data){
	var o;
	var cont = newElement("div.prettyprint-cont");
	var cb = newElement("input",['type','checkbox','checked','1']);
	cb.onchange = function(){
		var c = this.parentNode.parentNode;
		if(this.checked){
			query("textarea", c)[0].style.display = "none";
			query("pre", c)[0].style.display = "block";
		} else {
			query("textarea", c)[0].style.display = "block";
			query("pre", c)[0].style.display = "none";
		}
	}
	newElement("label",[], [cb, "pretty print"], cont);
	try {
		o = JSON.parse(data);
	} catch(e){
		return newElement("textarea", [], data);
	}
	var el = newElement("pre.json-print", [], null, cont);
	el.innerHTML =  prettifyJson(o);
	newElement("textarea", ['style','display:none'], data, cont);
	return cont;
}


function createRequestDetailContent(req){
	var tr;
	var cont = newElement("table.requestdetail-table");

	tr = newElement("tr", [], null, cont);
	newElement("td", [], "ID", tr);
	newElement("td", [], req.id, tr);

	tr = newElement("tr", [], null, cont);
	newElement("td", [], "Type", tr);
	newElement("td", [], req.type, tr);

	if(req.trigger){
		tr = newElement("tr", [], null, cont);
		newElement("td", [], "Trigger", tr);
		newElement("td", [], req.trigger, tr);
	}

	tr = newElement("tr", [], null, cont);
	newElement("td", [], "Method", tr);
	newElement("td", [], req.method, tr);

	tr = newElement("tr", [], null, cont);
	newElement("td", [], "URL", tr);
	newElement("td", [], req.url, tr);

	if(req.method != "GET"){
		tr = newElement("tr", [], null, cont);
		newElement("td", [], "Data", tr);
		newElement("td", [], prettyprintRequestData(req.data), tr);
	}

	tr = newElement("tr", [], null, cont);
	newElement("td", [], "Cookies", tr);
	newElement("td", [], prettyprintRequestData(req.cookies), tr);

	tr = newElement("tr", [], null, cont);
	newElement("td", [], "Extra headers", tr);
	newElement("td", [], prettyprintRequestData(req.extra_headers), tr);
	return cont;
}

function createSection(result){

	var founds = [];
	var urlicons = [];

	// if(!resultHasData(result))
	// 	return;

	if(result.out_of_scope || result.errors.indexOf('content_type') > -1)
		return;


	var accord = newElement("div.mainAccordion.accordion.accordion-closed");

	var parent = newElement("a.parent-url",['href',result.referer, 'target', '_blank','title','parent url'], result.referer);
	accord.appendChild(parent);
	for(var i = 0; i < types.length; i++){
		if(!(types[i] in result) || result[types[i]].length == 0) continue;
		founds.push(types[i]);
		var hdr = newElement("p.result-accordion-hdr.hdr-accordion.hdr-accordion-open",['data-for',types[i]], getLabel(types[i]), accord);
		hdr.onclick = function(){toggleAccordion(this)};
		newElement("span.result-counter",[],"",hdr)

		var resAccord = newElement("div.results.accordion",['data-for',types[i]]);
		for(var a = 0; a < result[types[i]].length; a++){
			var req = result[types[i]][a];

			if(types[i] == "errors"){
				cont = req;
			} else {
				var trigger = newElement("span.trigger",["data-trigger", req.trigger], "☍");
				var opener = newElement("span.opener",["title", "Show request details"], "♨");
				opener.onclick = (function(id){return function(){
					openModal("#request", createRequestDetailContent(getRequest(id)));
				}})(req.id);

				if(req.trigger){
					trigger.onclick = function(){
						this.textContent = this.textContent.length > 1 ? "☍" : this.getAttribute('data-trigger');
					}
					trigger.setAttribute("title","Show trigger element");
				} else {
					trigger.className += " empty";
				}

				var cont = [opener, trigger];
				if(typeof req == 'string'){
					cont.push(req);
				} else {
					var dirarrow = req.method != "GET" ? "❯ " : "❮ ";
					cont.push(newElement("span.result-post-data",['title', req.method, "style", "cursor:default"], dirarrow));
					cont.push(req.url + " ");
					cont.push(newElement("span.result-post-data", [], req.data.substring(0,300)));
				}

				//var cont = req.trigger + "-->" + result[types[i]][a].request;
				if(types[i] == "vulnerabilities"){//console.log(req)
					var vcont = JSON.parse(req);
					cont = newElement("span.vuln-name",[], getVulnName(vcont.type));
					cont.onclick = (function(c){return function(){
						openModal("#vulnerability", newElement("pre",[],c));
					}})(vcont.description);

				}
			}
			newElement("div.result",[], cont, resAccord);

		}
		accord.appendChild(resAccord);
	}

	var section = newElement("section",[
		"data-id", result.id,
		"data-method", result.method,
		"data-post-data", (result.data ? result.data : ""),
		"data-url", result.url, 
		"data-index", result.index, 
		"data-founds",founds.join(","),
		//"title", "Request ID: " + result.id
	]);
	var urlclass = ".url";
	var urlattrs = [];
	if('errors' in result && result.errors.length > 0){
		urlclass += ".url-error";
		urlattrs.push("title", "ERRORS");
	}

	var link_label = [(result.method == "POST" ? "POST " : "") + decodeURI(result.url)];
	if(result.data){
		link_label.push(" ");
		link_label.push(newElement("span.url-post-data", ['title','POST data'], result.data));
	}
	var link = newElement("span" + urlclass + ".hdr-accordion.hdr-accordion-closed", urlattrs, link_label);
	var ics = newElement("span.icons");

	for(var a = 0; a < types.length; a++){
		var ico = getIcon(types[a], founds);
		if(ico) ics.appendChild(ico)
	}


	link.onclick = function(){toggleAccordion(this)}
	var openico = newElement("a.open-new-win", ['href', result.url, 'target', '_blank', 'title', 'open in new window']);
	if(result.method == "POST"){
		openico.setAttribute("data-post-data", result.data ? result.data : "");
		openico.onclick = function(e){
			postForm(this.href, this.getAttribute("data-post-data"));
			e.preventDefault();
		}
	}
	var opener = newElement("span.opener",["title", "Show request details"], "♨");
		opener.onclick = (function(id){return function(){
			openModal("#request", createRequestDetailContent(getRequest(id)));
	}})(result.id);

	var trash = newElement("a.trash-button.button",[], 'trash');
	trash.onclick = (function(target){ return function(){
		toggleTrashSection(target);
	}})(section);
	var next = newElement("a.next-button.button",[], 'next');
	next.onclick = (function(target){ return function(){
		nextSection(target);
	}})(section);

	var mark = newElement("a.mark-button.button",[], 'mark');
	mark.onclick = (function(target){ return function(){
		target.classList.toggle("marked");
	}})(section);

	newElement("div.resbuttons",[],[next,mark,trash], accord);

	// 2 sec senza crearli
	// 4.5 sec senza appen
	// 6 sec hidden
	// 9 sec full

	section.appendChild(ics);
	section.appendChild(openico);
	section.appendChild(opener);
	section.appendChild(link);
	section.appendChild(accord);

	result.html_element = section;
	//}
}





function createSections(limit){
	var results = report.results;
	var cont = query("#report");

	var url;
	var cnt = 0;
	var index = 0;
	for(var a = 0; a < results.length; a++){

		if('html_element' in results[a]){
			index++;
			continue;
		}

		if(cnt == limit){
			break;
		}


		createSection(results[a], index);
		if('html_element' in results[a]){

			cont.appendChild(results[a].html_element);
			results[a].index = index;

			index++;
			cnt++;
		}
	}

	if(cnt > 0)
		filter();

}



function insertSection(section){
	var index = parseInt(section.getAttribute("data-index"));
	var sections = query("#report section");
	var next = null;
	for(var a = 0; a < sections.length; a++){
		if(parseInt(sections[a].getAttribute("data-index")) > index){
			next = sections[a];
			break;
		}
	}

	query("#report").insertBefore(section, next);

}


function sortSections(){
	return


	var cont = query('#report');
	var secs = query("section .url", cont);

	if(secs.length < 2){
		return;
	}
	var list = [];
	for(var a = 0; a < secs.length;a++){
		list.push(secs[a]);
	}


	list = list.sort(function(a,b){
		if(a.textContent.toLowerCase() == b.textContent.toLowerCase())
			return 0;
		return a.textContent.toLowerCase() > b.textContent.toLowerCase() ? 1 : -1; 
	})

	// for(var a = 0 ;a < list.length;a++)
	// 	console.log(list[a].textContent.toLowerCase())

	var next = secs[0].parentNode;
	for(var a = 0; next && a < secs.length; a++){
		cont.insertBefore(list[a].parentNode, next);
		next = list[a].parentNode.nextSibling;
	}
}




function toggleAccordion(el,forceState){
	var st = {open: 'accordion-open', closed:'accordion-closed'};
	if(!el) return;
	var hdr = el;
	do{
		if(el && el.className && el.classList.contains("accordion")/*el.className.split(" ").indexOf('accordion') > -1*/)
			break;
	} while(el = el.nextSibling);

	if(!el) return;

	do{
		if(hdr && hdr.classList.contains("hdr-accordion"))
			break
	}while(hdr = hdr.previousSibling);

	var state;

	if(forceState){
		state = forceState;
	} else{
		state = el.classList.contains(st.open) ? "closed" : "open";
	}

	if(state == "closed"){
		el.classList.add(st.closed);
		el.classList.remove(st.open);
		if(hdr){
			hdr.classList.add("hdr-" + st.closed);
			hdr.classList.remove("hdr-" + st.open);
		}
	} else {
		el.classList.add(st.open);
		el.classList.remove(st.closed);
		if(hdr){
			hdr.classList.add("hdr-" + st.open);
			hdr.classList.remove("hdr-" + st.closed);
		}
	}

}



function filterSections(showFilters){


	// alemeno un el di a1 e' contenuto in a2
	var arraysub = function(a1, a2){
		for(var a = 0; a < a2.length; a++){
			if(a1.indexOf(a2[a]) > -1)
				return true
		}
		return false;
	}

	var errcont = query("#error_container");
	errcont.innerText = '';


	els = query("#report section");
	for(var a = 0; a < els.length; a++){
		var founds = els[a].getAttribute("data-founds");
		if(!founds)continue;
		///console.log(founds.split(","))
		els[a].classList[!arraysub(showFilters, founds.split(",")) ? 'add' : 'remove']('hidden');

	}

}



function filter(fromindex){
	fromindex = fromindex || 0;


	var errcont = query("#error_container");
	errcont.innerText = '';
	// checkbox filters
	var els = query("#filters").getElementsByTagName("input");
	var sel = [];
	var sum = 0;
	for(var a = 0; a < els.length; a++){
		if(els[a].checked == true){
			sel.push(els[a].name);
			sum++;
		}
	}
	var af = query("#allfilters");
	af.checked = sum >= (els.length/2) ? true : false;
	af.indeterminate = (sum > 0 && sum != els.length) ? true : false;

	filterSections(sel);


	// url hider filter
	var regexp = query('#urlhider').value.replace(/\n/g,"");
	var rows = query("[data-url]");

	for(var a = 0; a < rows.length; a++){
		var method = rows[a].getAttribute("data-method") ? rows[a].getAttribute("data-method") + " " : "";
		var url = method + rows[a].getAttribute("data-url") + " " + rows[a].getAttribute("data-post-data");
		if(!rows[a].classList.contains("hidden")){ // already hidden by checkbox filter
			try{
				rows[a].classList[(regexp == "" || url.trim().match(new RegExp(regexp,"gi")) == null) ? 'remove' : 'add']('hidden');
			}catch(e){
				errcont.innerText = e.message;
			}
		}
	}


	// results hider filter
	var regexp = query('#reshider').value.replace(/\n/g,"");
	var rows = query(".result");
	for(var a = 0; a < rows.length; a++){
		var cont = rows[a].textContent;
		try{
			rows[a].classList[(regexp == "" || cont.match(new RegExp(regexp,"gi")) == null) ? 'remove' : 'add']('hidden');
		}catch(e){
			errcont.innerText = e.message;
		}
	}


	//results accoridion autocollapse and counting
	els = query('#report section');
	for(var a = 0; a < els.length; a++){
		var res = query('.mainAccordion .results',els[a]);

		for(var b = 0; b < res.length; b++){
			var counter = query(".result-counter",res[b].previousSibling)[0];
			counter.textContent = query(".result",res[b]).length;
			var state = query('#opt_'+res[b].getAttribute("data-for")).checked;
			toggleAccordion(res[b], state ? "open" : "closed");
		}
	}

	// set icon red if resutl is filtered
	els = query("#report section");
	for(var a = 0; a < els.length; a++){
		var ics = els[a].querySelectorAll(".icon");
		for(var b = 0; b < ics.length; b++){
			var sel = '.results[data-for="'+ics[b].getAttribute('data-for')+'"] .result:not(.hidden)';
			var n = els[a].querySelector(sel);
			//console.log("-->"+n)
			ics[b].classList[n  ? 'remove':'add']("icon-filtered");

		}
	}

}


function postForm(url, data){
	data = data.split(/(?:&amp;|&)+/);
	var form = newElement("form.hidden", ['method','POST', 'action', url, 'target','_blank']);
	for(var a = 0; a < data.length; a++){
		var d = data[a].split(/=(.*)/);
		newElement("input", ['name', d[0], 'value', d[1]], [], form);
	}
	form.submit();
}


function openMarked(){
	var cont = query("#marked .modal-content")[0];
	var marked = query("#report section.marked");
	if(marked.length == 0) return;

	for(var a = 0; a < marked.length; a++){
		cont.appendChild(marked[a]);
	}
	var hidden = query(".hidden",cont);
	for(var a = 0; a < hidden.length; a++){
		hidden[a].classList.remove('hidden');
		hidden[a].classList.add('was-hidden');
	}
	query("#marked").classList.remove("hidden");
	document.querySelector("body").style.overflow = 'hidden';
}

function closeMarked(){
	if(query("#marked").classList.contains("hidden"))return;
	var hidden = query(".was-hidden",query("#marked .modal-content")[0]);
	for(var a = 0; a < hidden.length; a++){
		hidden[a].classList.add('hidden');
		hidden[a].classList.remove('was-hidden');
	}
	document.querySelector("body").style.overflow = 'visible';
	query('#marked').classList.add("hidden");
	var els = query('#marked .modal-content section');
	for(var a = 0; a < els.length; a++){
		//query("#report").appendChild(els[a]);
		insertSection(els[a])
	}
	//sortSections();

}

function nextSection(current){

	var cont = getComputedStyle(current.parentNode).getPropertyValue('overflow') == 'auto' ? current.parentNode : document.body;
	toggleAccordion(query(".mainAccordion",current)[0]);
	//console.log(elementHeight(current))
	cont.scrollTop = document.body.scrollTop + elementHeight(current);

	var next = current.nextSibling;
	while(next){
		if(!next.classList.contains('hidden')){
			break
		}
		next = next.nextSibling;
	} 

	if(next)
		toggleAccordion(query(".mainAccordion",next)[0], "open");
}


function addRegexp(target){
	var txt = window.getSelection().toString();
	if(txt == "") return;
	var cont = query(target);
	// quote string for regesp
	//txt = "(" + txt.replace(/([.*+?^${}()|\[\]\/\\])/g, "\\$1") + ")";
	txt = "(" + txt.replace(/([.*+?^${}()|\[\]\\])/g, "\\$1") + ")";
	if(cont.value != ""){
		txt = cont.value + "|" + txt;
	}
	cont.value = txt;
	cont.onblur();

}

// check if result has data so section will be created
function resultHasData(result){
	if('out_of_scope' in result)
		return false;
	for(var a = 0; a < types.length; a++){
		if(types[a] in result && result[types[a]].length > 0)
			return true;
	}

	return false;
}

function openModal(selector, content){
	document.querySelector("body").style.overflow = 'hidden';
	query(selector).classList.remove("hidden");

	if(content){
		var c = query(selector +  " .modal-content")[0];
		c.innerHTML = "";
		c.scrollTo(0, 0);
		c.appendChild(content);
	}
}

function closeModal(selector){
	document.querySelector("body").style.overflow = 'visible';
	if(selector){
		query(selector).classList.add("hidden");
	} else {
		var modals = query(".modal");
		for(var a = 0; a < modals.length; a++){
			modals[a].classList.add("hidden");
		}
	}
}


function getRequest(id){
	var results = report.results;
	var types_req = ['xhr','jsonp','websocket', 'fetch', 'form'];
	for(var a = 0; a < results.length; a++){
		if(id == results[a].id){
			return results[a];
		}
		//console.log(results[a])
		for(var b = 0; b < types_req.length; b++){
			if(types_req[b] in results[a]){
				for(var i = 0; i < results[a][types_req[b]].length; i++){
					if(results[a][types_req[b]][i].id == id){
						return results[a][types_req[b]][i];
					}
				}
			}
		}
	}
	return null;
}


function saveStatus(){
	var a;
	var status = {
		shown: [],
		marked:[],
		trashed:[],
		hideUrls: "",
		hideResults: "",
		notes: ""

	};
	if(!query("#save_status").classList.contains("hidden")){
		query("#save_status").classList.add("hidden");
		return;
	}
	var shown = query("#filters input");
	for(a = 0; a < shown.length; a++){
		if(shown[a].checked)
			status.shown.push(shown[a].id);
	}
	var marked = query("#report section.marked");
	for(a = 0; a < marked.length; a++){
		status.marked.push(marked[a].getAttribute("data-index"));
	}

	var trashed = query("#trash section");
	for(a = 0; a < trashed.length; a++){
		status.trashed.push(trashed[a].getAttribute("data-index"));
	}

	status.hideUrls = query("#urlhider").value;
	status.hideResults = query("#reshider").value;
	status.notes = query("#notes textarea")[0].value;

	var blob = new Blob([JSON.stringify(status)], {type: "application/octet-stream"});
	query("#save_status a")[0].href = window.URL.createObjectURL(blob);
	query("#save_status").classList.remove("hidden");
	query("#save_status input")[0].focus();

}

function loadStatus(file){
	var reader = new FileReader();

	reader.onload = function(event) {
		var doFilter = false;
		try{
			var status = JSON.parse(event.target.result);
		} catch(e){
			query("#error_container").innerText = e;
			return;
		}
		if('shown' in status){
			var shown = query("#filters input");
			for(var a = 0; a < shown.length; a++){
				var checked = status.shown.indexOf(shown[a].id) != -1;
				if(!doFilter) 
					doFilter = shown[a].checked != checked;
				shown[a].checked = checked;
			}
		}
		if('marked' in status){
			for(var a = 0; a < status.marked.length; a++){
				// any section, both from #report and #trash
				var sec = document.querySelector('section[data-index="'+status.marked[a]+'"]');
				if(sec) sec.classList.add("marked");
			}
		}
		if('trashed' in status){
			for(var a = 0; a < status.trashed.length; a++){
				// trash only section in #report
				var sec = document.querySelector('#report section[data-index="'+status.trashed[a]+'"]');
				if(sec) toggleTrashSection(sec);
			}
		}

		if('hideUrls' in status){
			var hu = query("#urlhider");
			if(!doFilter)
				doFilter = hu.value != status.hideUrls;
			hu.value = status.hideUrls;
		}
		if('hideResults' in status){
			var hr = query("#reshider");
			if(!doFilter)
				doFilter = hr.value != status.hideResults;
			hr.value = status.hideResults;
		}

		if('notes' in status){
			query("#notes textarea")[0].value = status.notes;
		}

		if(doFilter){
			filter();
		}

		var ssi = query("#save_status input")[0];
		ssi.value = file.name
		ssi.onblur();
	};

	reader.readAsText(file);
}

function prettifyJson(obj, layer){
	var i, br
		html = "",
		pd = " ".repeat(2);

	if(!layer)layer = 1;

	switch(typeof obj){
		case "object":
			if(!obj){
				return "<span class=jsn-null>" + obj + "</span>";
			}
			if(obj.constructor == Array){
				br = ['[', ']'];
				for(i = 0; i < obj.length; i++){
					html += "<p>" + pd.repeat(layer) + prettifyJson(obj[i], layer + 1);
					html += i < obj.length-1 ? "," : "" + "</p>";
				}
			} else {
				br = ['{', '}'];
				var props = Object.keys(obj);
				for(i = 0; i < props.length; i++){
					html += "<p>" + pd.repeat(layer) + '<span class=jsn-prop>"' + props[i] + '"</span>: ';
					html += prettifyJson(obj[props[i]], layer + 1);
					html += i < props.length-1 ? "," : "" + "</p>";
				}
			}
			if(!html) return br.join("");
			// padding of prv layer to align the closing bracket
			return br[0] + pd.repeat(layer-1) + html + br[1];
		case "string":
			var printableHtml = obj.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
			return "<span class=jsn-string>" + JSON.stringify(printableHtml) + "</span>";
	}
	return "<span class=jsn-" + typeof obj + ">" + obj + "</span>";
}



function initGUI(){

	var infos = report.infos;

	var filters = query("#filters");

	query("#htcap_version").textContent = infos.htcap_version;

	query('#allfilters').onchange = function(){
		var f = query('#filters').getElementsByTagName("input");
		for(var a = 0; a < f.length; a++)
			f[a].checked = this.checked;
		filter();
	}

	query('#urlhider').onblur = filter;
	query('#reshider').onblur = filter;

	query('#trash-close').onclick = function(){
		closeModal("#trash");
	}

	query('#vulnerability-close').onclick = function(){
		closeModal("#vulnerability");
	}

	query('#notes-close').onclick = function(){
		closeModal("#notes");
	}

	query('#marked-close').onclick = closeMarked;

	query('#outofscope-close').onclick = function(){
		closeModal("#outofscope");
	};

	query('#request-close').onclick = function(){
		closeModal("#request");
	};


	var btn;
	var buttons = query("#buttons");

	//btn = newElement("span.button",[],"open marked",buttons);
	query("#marked-open").onclick = openMarked

	query("#trash-open").onclick = function(){
		openModal("#trash");
	}

	query("#notes-open").onclick = function(){
		openModal("#notes");
		query("#notes textarea")[0].focus();
	}

	query("#collapse-all").onclick = function(){
		var els = query("#report section .mainAccordion");
		for(var a = 0; a < els.length; a++){
			toggleAccordion(els[a],'closed');
		}
	}

	//btn = newElement("span.button",[],"expand visibles",buttons);
	query("#expand-visibles").onclick = function(){
		var els = query("#report section:not(.hidden) .mainAccordion");
		for(var a = 0; a < els.length; a++){
			toggleAccordion(els[a],'open');
		}
	}

	query("#outofscope-open").onclick = function(){
		document.querySelector("body").style.overflow = 'hidden';
		query("#outofscope").classList.remove("hidden");
	}


	query("#nonhtml-open").onclick = function(){
		openModal("#nonhtml");
	}
	query('#nonhtml-close').onclick = function(){
		closeModal("#nonhtml");
	};


	query("#save-status").onclick = function(){
		saveStatus();
	};

	query("#save_status input")[0].onblur = function(){
		query("#save_status a")[0].download = this.value || this.placeholder;
	}
	query("#save_status a")[0].onclick = function(){
		query("#save_status").classList.add("hidden");
	};

	query("#load_status_input").onchange = function(){
		loadStatus(this.files[0]);
	}

	//newElement("span",['id','error_container'],'',buttons);


	document.addEventListener("mouseup", function(e){
		var txt = window.getSelection().toString();
		query("#add_result_regexp").classList[(txt == "" ? 'add' : 'remove')]("hidden");
		query("#add_url_regexp").classList[(txt == "" ? 'add' : 'remove')]("hidden");
	});

	query("#add_result_regexp").onmousedown = function(){addRegexp('#reshider')};
	query("#add_url_regexp").onmousedown = function(){addRegexp('#urlhider')};

	var scan_time = parseInt((infos.end_date - infos.start_date) / 60);
	if(scan_time < 0){
		scan_time = "-1";
	}
	var scan_date = (new Date(parseInt(infos.start_date) * 1000)).toString();
	query('#infos_target').appendChild(document.createTextNode(infos.target));
	query('#infos_scan_date').appendChild(document.createTextNode(scan_date));
	query('#infos_scanned_urls').appendChild(document.createTextNode(infos.pages_crawled));
	query('#infos_scan_time').appendChild(document.createTextNode(scan_time + " minutes"));
	query('#infos_commandline').appendChild(document.createTextNode("crawl " + infos.commandline));

	for(var i = 0; i < types.length; i++){
		var l = types[i];

		var opt = newElement('input',['type','checkbox','id','opt_'+l,'name',l,'checked',true]);
		opt.onchange = filter;

		//var opt_l = newElement("label",['for',opt.id], labels[l] + " ")
		var opt_l = newElement("label",['for',opt.id], getLabel(l) + " ")

		filters.appendChild(opt);
		filters.appendChild(opt_l);
	}


	window.onscroll = (function(height){return function(){
		var h = height - window.pageYOffset;
		query("#collapse_top").style.height = (h > -1 ? h : 0) + "px";

	}})(elementHeight(query("#collapse_top")));

	document.onkeydown = function(e){
		if(e.keyCode == 27){
			closeMarked();
			closeModal();
		}
	}
}


function initReport(){

	var results = report.results;


	initGUI();

	var tot_outofscope = 0;
	var tot_nonhtml = 0;
	var index = 0;
	var modalurl;
	for(var a = 0; a < results.length; a++){

		if('out_of_scope' in results[a] || results[a].errors.indexOf('content_type') > -1){
			if('out_of_scope' in results[a]){
				modalurl = newElement("p",[],null, query("#outofscope .modal-content")[0]);
				tot_outofscope++;
			} else {
				modalurl = newElement("p",[],null, query("#nonhtml .modal-content")[0]);
				tot_nonhtml++;
			}
			newElement("a.url",['href',results[a].url, 'target','_blank'],results[a].url, modalurl);
			newElement("br",[],"",modalurl);
			newElement("a.parent-url",['href',results[a].referer, 'target','_blank','title','parent url'], results[a].referer, modalurl);

		}

		if(resultHasData(results[a])){
			results[a].index = index++;
		}

	}

	createSections(-1);

	query("#infos_outofscope").textContent = tot_outofscope;
	query("#infos_nonhtml").textContent = tot_nonhtml;

	var links = query("a");
	for(var a = 0; a < links.length; a++){
		links[a].setAttribute('tabindex', "-1");
	}

	//query("body")[0].style.paddingTop = 20 + elementHeight(query("#top")) + "px";
	query("#report").style.marginTop = 20 + elementHeight(query("#top")) + "px";


	window.onbeforeunload = function(e){
		var mess = "Are you sure?"
		return mess;
	};

}
</script>
</head>


<body onload="initReport()">
<div id=top>
	<div id="collapse_top">
		<div id=top_header>
			<p id=title>Htcap <span id=htcap_version></span> Report</p>
			<hr>
			<table id=infos>
				<tr><td nowrap>Target:</td><td id=infos_target></td></tr>
				<tr><td nowrap>Crawl date:</td><td id=infos_scan_date></td></tr>
				<tr><td nowrap>Pages crawled:</td><td id=infos_scanned_urls></td></tr>
				<tr><td nowrap>Crawl duration:</td><td id=infos_scan_time></td></tr>
				<tr><td nowrap>Out of scope:</td><td>
					<span id=infos_outofscope></span> 
					<span class=button id=outofscope-open>open</span>
				</td></tr>
				<tr><td nowrap>Non HTML:</td><td>
					<span id=infos_nonhtml></span> 
					<span class=button id=nonhtml-open>open</span>
				</td></tr>
				<tr><td nowrap>Command:</td><td id=infos_commandline></td></tr>
			</table>

		</div>
	</div>
	<hr>

	<div id=filtersbox>
		<form>
			<div>
				<span><input type=checkbox id=allfilters> <b>Show:</b> </span> <span id=filters></span>
			</div>
			<table>
				<tr>
					<td>Hide Urls: <p class="hidden addregexp" id=add_url_regexp>add selected</p></td>
					<td><textarea id=urlhider tabindex=1  title='write here a regexp to hide matched urls'></textarea></td>
					<td>&nbsp;</td>
					<td>Hide Results: <p class="hidden addregexp" id=add_result_regexp>add selected text</p></td>
					<td><textarea id=reshider tabindex=2 title='write here a regexp to hide matched results'></textarea></td>
				</tr>
			</table>
		</form>
	</div>
	<div id=buttons>
		<span class=button id=notes-open>open notes</span>
		<span class=button id=marked-open>open marked</span>
		<span class=button id=trash-open>open trash</span>
		<span class=button-spacer>&nbsp;</span>
		<span class=button id=collapse-all>collapse all</span>
		<span class=button id=expand-visibles>expand visibles</span>
		<span class=button-spacer>&nbsp;</span>
		<label for="load_status_input" class=button>load session</label><input style='display:none' type=file id="load_status_input">
		<span class=button id=save-status>save session</span>
		<span id=save_status class="hidden">
			<input type=text placeholder="htcap_report_status.json"> <a class=button href="" download="">save</a>
		</span>
		<span id=error_container></span>

	</div>
	<hr>
</div>

<div id=report></div>


<div id=marked class="modal hidden">
	<div class=modal-bar>
		Marked
		<div id='marked-close' title=close>&#215;</div>
	</div>
	<div class=modal-content></div>
</div>


<div id=trash class="modal hidden">
	<div class=modal-bar>
		Trash
		<div id='trash-close' title=close>&#215;</div>
	</div>
	<div class=modal-content></div>
</div>


<div id=notes class="modal hidden">
	<div class=modal-bar>
		Notes
		<div id='notes-close' title=close>&#215;</div>
	</div>
	<div class=modal-content>
		<textarea></textarea>
	</div>
</div>



<div id=outofscope class="modal hidden">
	<div class=modal-bar>
		Out of scope
		<div id='outofscope-close' title=close>&#215;</div>
	</div>
	<div class=modal-content></div>
</div>

<div id=nonhtml class="modal hidden">
	<div class=modal-bar>
		Non HTML Documents
		<div id='nonhtml-close' title=close>&#215;</div>
	</div>
	<div class=modal-content></div>
</div>



<div id=vulnerability class="modal hidden">
	<div class=modal-bar>
		Vulnerability Details
		<div id='vulnerability-close' title=close>&#215;</div>
	</div>
	<div class=modal-content></div>
</div>


<div id=request class="modal hidden">
	<div class=modal-bar>
		Request Details
		<div id='request-close' title=close>&#215;</div>
	</div>
	<div class=modal-content></div>
</div>

</body>


</html>
